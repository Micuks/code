本节介绍对HUMI, PRES和TEMP三列进行线性插值处理, 并截断其中超出三倍标准差的数据.\par

对线性插值和高度异常数据(超过3倍标准差)的数据的处理, 在类DataProcess中的函数
linear\_interpolate()中.\par

\subsection{实现介绍}
使用pandas的函数interpolate()对数据进行线性插值处理如下:
\begin{lstlisting}
    # Linear interpolate
    new_col = column.interpolate(
        method="linear", limit_direction="forward")
\end{lstlisting}

由于pandas是numpy的扩展, 所以很好的继承了numpy的特性, 例如下面用到的Boolean
Array.
对数据中超出三倍标准差的数据, 通过如下方式截断为三倍标准差:
\begin{lstlisting}
    # Process highly anomalous data that exceeds 3 standard deviations.
    std = column.std()
    mean = column.mean()
    new_col[column > mean + 3 * std] = 3 * std + mean
    new_col[column < mean - 3 * std] = 3 * std - mean
\end{lstlisting}

\subsection{处理结果}
使用样例数据进行测试. 测试结果中省略了不相关的列:
\begin{lstlisting}
    # Raw data before process.
                         No  season  ...  DEWP   HUMI  PRES  TEMP ...
    Date
    2010-01-01 00:00:00   1       4  ...   -21   43.0  1021   -11 ...
    2010-01-01 01:00:00   2       4  ...   -21   47.0  1020   -12 ...
    2010-01-01 02:00:00   3       4  ...   -21   43.0  1019   -11 ...
    2010-01-01 03:00:00   4       4  ...   -21   55.0  1019   -14 ...
    2010-01-01 04:00:00   5       4  ...   -20    NaN  1018   -12 ...
    2010-01-01 05:00:00   6       4  ...   -19   47.0  1017   -10 ...
    2010-01-01 06:00:00   7       4  ...   -19   44.0  1017    -9 ...
    2010-01-01 07:00:00   8       4  ...   -19  440.0  1017    -9 ...
    2010-01-01 08:00:00   9       4  ...   -19   44.0  1017    -9 ...
    2010-01-01 09:00:00  10       4  ...   -20   37.0  1017    -8 ...

    # Run log.
    Linear interpolate and process highly anomalous data in HUMI.
    Modified 1 cells.
    Linear interpolate and process highly anomalous data in PRES.
    Modified 0 cells.
    Linear interpolate and process highly anomalous data in PRES.
    Modified 0 cells.

    # Processed data.
                         No  season  ...  DEWP   HUMI  PRES  TEMP ...
    Date
    2010-01-01 00:00:00   1       4  ...   -21   43.0  1021   -11 ...
    2010-01-01 01:00:00   2       4  ...   -21   47.0  1020   -12 ...
    2010-01-01 02:00:00   3       4  ...   -21   43.0  1019   -11 ...
    2010-01-01 03:00:00   4       4  ...   -21   55.0  1019   -14 ...
    2010-01-01 04:00:00   5       4  ...   -20   51.0  1018   -12 ...
    2010-01-01 05:00:00   6       4  ...   -19   47.0  1017   -10 ...
    2010-01-01 06:00:00   7       4  ...   -19   44.0  1017    -9 ...
    2010-01-01 07:00:00   8       4  ...   -19  440.0  1017    -9 ...
    2010-01-01 08:00:00   9       4  ...   -19   44.0  1017    -9 ...
    2010-01-01 09:00:00  10       4  ...   -20   37.0  1017    -8 ...
\end{lstlisting}
可以看到HUMI中的NaN被插值为51.0.

对完整数据集进行测试, 根据输出日志可以看到, 三列中均有数据被进行过插值或修改到三倍标准差内.
\begin{lstlisting}
Linear interpolate and process highly anomalous data in HUMI.
Modified 339 cells.
Linear interpolate and process highly anomalous data in PRES.
Modified 339 cells.
Linear interpolate and process highly anomalous data in PRES.
Modified 5 cells.
\end{lstlisting}