本节介绍对PM\_Dongsi, PM\_Dongsihuan和PM\_Nongzhanguan三列中PM指数超过500的异常
数据进行处理. 处理方法为将其截断为500.\par

\subsubsection{实现介绍}
类似上一节中提到的方式, 使用pandas中DataFrame的Boolean Array对每一列col中的异常数据进行处理:
\begin{python}
    def process(col):
        cp = col.copy()
        print(f"Handled {len([x for x in cp[cp > 500]])} values")
        cp[cp > 500] = 500

        return cp
\end{python}

\subsubsection{处理结果}
对样例数据进行测试, 测试结果中省略了不相关的列:
\begin{lstlisting}
    # Raw data before process.
                         No  season  PM_Dongsi  PM_Dongsihuan  PM_Nongzhanguan  ...
    Date
    2010-01-01 00:00:00   1       4        NaN            NaN              NaN  ...
    2010-01-01 01:00:00   2       4        NaN            NaN              NaN  ...
    2010-01-01 02:00:00   3       4        NaN            NaN              NaN  ...
    2010-01-01 03:00:00   4       4        NaN            NaN            858.0  ...
    2010-01-01 04:00:00   5       4        NaN           39.0              NaN  ...
    2010-01-01 05:00:00   6       4        NaN            NaN              NaN  ...
    2010-01-01 06:00:00   7       4        NaN         1871.0              NaN  ...
    2010-01-01 07:00:00   8       4       17.0            NaN              NaN  ...
    2010-01-01 08:00:00   9       4        NaN            NaN              NaN  ...
    2010-01-01 09:00:00  10       4        NaN            NaN              NaN  ...
    
    # Run log.
    Handle values larger than 500 in PM_Dongsi.
    Handled 0 values
    Handle values larger than 500 in PM_Dongsihuan.
    Handled 1 values
    Handle values larger than 500 in PM_Nongzhanguan.
    Handled 1 values
    
    # Processed data.
                         No  season  PM_Dongsi  PM_Dongsihuan  PM_Nongzhanguan  ...
    Date
    2010-01-01 00:00:00   1       4        NaN            NaN              NaN  ...
    2010-01-01 01:00:00   2       4        NaN            NaN              NaN  ...
    2010-01-01 02:00:00   3       4        NaN            NaN              NaN  ...
    2010-01-01 03:00:00   4       4        NaN            NaN            500.0  ...
    2010-01-01 04:00:00   5       4        NaN           39.0              NaN  ...
    2010-01-01 05:00:00   6       4        NaN            NaN              NaN  ...
    2010-01-01 06:00:00   7       4        NaN          500.0              NaN  ...
    2010-01-01 07:00:00   8       4       17.0            NaN              NaN  ...
    2010-01-01 08:00:00   9       4        NaN            NaN              NaN  ...
    2010-01-01 09:00:00  10       4        NaN            NaN              NaN  ...
\end{lstlisting}
可以看到, PM\_Dongsihuan列中值为1871.0的数值被截断为500.0; PM\_Nongzhanguan中值
为858.0的被截断为500.0. 对不超过500.0的值不进行处理.\par

对完整数据集进行测试, 根据输出日志可以看到, 三列中均有PM指数超过500的异常数据被
进行了截断.
\begin{lstlisting}
Handle values larger than 500 in PM_Dongsi.
Handled 70 values
Handle values larger than 500 in PM_Dongsihuan.
Handled 75 values
Handle values larger than 500 in PM_Nongzhanguan.
Handled 81 values
\end{lstlisting}